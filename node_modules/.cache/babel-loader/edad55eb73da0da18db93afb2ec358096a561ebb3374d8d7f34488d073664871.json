{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Charly/OneDrive/Documentos/HACKATHONES/AIlabs/AI-minds/react-front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Charly/OneDrive/Documentos/HACKATHONES/AIlabs/AI-minds/react-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Charly/OneDrive/Documentos/HACKATHONES/AIlabs/AI-minds/react-front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import teacher from'../assets/teacher.png';import'../index.css';import MicRecorder from'mic-recorder-to-mp3';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function TeacherComponent(_ref){var userData=_ref.userData;var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),responseText=_React$useState2[0],setResponseText=_React$useState2[1];var recorder=useRef(null);//Recorder\nvar audioPlayer=useRef(null);//Ref for HTML Audio tag\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),transcriptionText=_useState2[0],setTranscriptionText=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),blobURL=_useState4[0],setBlobUrl=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),isRecording=_useState6[0],setIsRecording=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),play=_useState8[0],setPlay=_useState8[1];useEffect(function(){//Declares the recorder object and stores it in ref\nrecorder.current=new MicRecorder({bitRate:128});setTranscriptionText('');},[]);var startRecording=function startRecording(){//start() returns a promise incase if audio is not blocked by browser\nrecorder.current.start().then(function(){setIsRecording(true);});};var stopRecording=function stopRecording(){recorder.current.stop().getMp3().then(function(_ref2){var _ref3=_slicedToArray(_ref2,2),buffer=_ref3[0],blob=_ref3[1];var newBlobUrl=URL.createObjectURL(blob);//generates url from blob\nsetBlobUrl(newBlobUrl);//refreshes the page\nsetIsRecording(false);sendAudioToServer(blob);}).catch(function(e){return console.log(e);});};var sendAudioToServer=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(blob){var audioFile,formData,response,data,audio,transcriptionWithUserName;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:audioFile=new File([blob],\"audio_file\",{type:\"audio/mp3\"});formData=new FormData();formData.append('audio',audioFile);formData.append('user_name',userData.name);formData.append('native_language',userData.nativeLanguage);formData.append('target_language',userData.learningLanguage);console.log(blob);_context.next=9;return fetch('http://localhost:5000/start_conversation',{method:'POST',body:formData});case 9:response=_context.sent;_context.next=12;return response.json();case 12:data=_context.sent;console.log(data);setResponseText(data.text_response);audio=new Audio(\"data:audio/wav;base64,\".concat(data.audio_response));transcriptionWithUserName=\"\".concat(userData.name,\": \").concat(data.transcript);setTranscriptionText(transcriptionWithUserName);audio.play();case 19:case\"end\":return _context.stop();}},_callee);}));return function sendAudioToServer(_x){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(\"img\",{src:teacher,alt:\"Personaje\",className:\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-2/3 w-1/2 md:w-1/3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-0 left-0 w-full h-2/4 bg-black bg-opacity-50 p-4 rounded-t\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-6xl font-bold mb-4 text-white text-center\",children:\"Hello I'am your teacher\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full p-2 mb-4 h-40\",readOnly:true,value:responseText}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",className:\"w-full p-2\",placeholder:\"Introduce tu texto aqu\\xED\",value:transcriptionText}),/*#__PURE__*/_jsx(\"button\",{onClick:startRecording,disabled:isRecording,children:\"Record\"}),/*#__PURE__*/_jsx(\"button\",{onClick:stopRecording,disabled:!isRecording,children:\"Stop\"}),/*#__PURE__*/_jsx(\"audio\",{ref:audioPlayer,src:blobURL,controls:\"controls\",onEnded:function onEnded(){return setPlay(false);}//event handler when audio has stopped playing\n})]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","teacher","MicRecorder","jsx","_jsx","jsxs","_jsxs","TeacherComponent","_ref","userData","_React$useState","_React$useState2","_slicedToArray","responseText","setResponseText","recorder","audioPlayer","_useState","_useState2","transcriptionText","setTranscriptionText","_useState3","_useState4","blobURL","setBlobUrl","_useState5","_useState6","isRecording","setIsRecording","_useState7","_useState8","play","setPlay","current","bitRate","startRecording","start","then","stopRecording","stop","getMp3","_ref2","_ref3","buffer","blob","newBlobUrl","URL","createObjectURL","sendAudioToServer","catch","e","console","log","_ref4","_asyncToGenerator","_regeneratorRuntime","mark","_callee","audioFile","formData","response","data","audio","transcriptionWithUserName","wrap","_callee$","_context","prev","next","File","type","FormData","append","name","nativeLanguage","learningLanguage","fetch","method","body","sent","json","text_response","Audio","concat","audio_response","transcript","_x","apply","arguments","className","children","src","alt","readOnly","value","placeholder","onClick","disabled","ref","controls","onEnded"],"sources":["C:/Users/Charly/OneDrive/Documentos/HACKATHONES/AIlabs/AI-minds/react-front/src/components/TeacherComponent.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport teacher from '../assets/teacher.png';\r\nimport '../index.css';\r\nimport MicRecorder from 'mic-recorder-to-mp3';\r\n\r\nexport default function TeacherComponent({ userData }) {\r\n  const [responseText, setResponseText] = React.useState('');\r\n  const recorder = useRef(null); //Recorder\r\n  const audioPlayer = useRef(null); //Ref for HTML Audio tag\r\n  const [transcriptionText, setTranscriptionText] = useState(\"\");\r\n  const [blobURL, setBlobUrl] = useState(null);\r\n  const [isRecording, setIsRecording] = useState(null);\r\n  const [play, setPlay] = useState(false);\r\n\r\n  useEffect(() => {\r\n    //Declares the recorder object and stores it in ref\r\n    recorder.current = new MicRecorder({ bitRate: 128 });\r\n    setTranscriptionText('');\r\n  }, []);\r\n  const startRecording = () => {\r\n    //start() returns a promise incase if audio is not blocked by browser\r\n    recorder.current.start().then(() => {\r\n      setIsRecording(true);\r\n    });\r\n  };\r\n  const stopRecording = () => {\r\n    recorder.current\r\n      .stop()\r\n      .getMp3()\r\n      .then(([buffer, blob]) => {\r\n        const newBlobUrl = URL.createObjectURL(blob); //generates url from blob\r\n        setBlobUrl(newBlobUrl); //refreshes the page\r\n        setIsRecording(false);\r\n        sendAudioToServer(blob);\r\n      })\r\n      .catch((e) => console.log(e));\r\n  };\r\n\r\n  const sendAudioToServer = async (blob) => {\r\n    const audioFile = new File([blob], \"audio_file\",{type: \"audio/mp3\"});\r\n    const formData = new FormData();\r\n    formData.append('audio', audioFile);\r\n    formData.append('user_name', userData.name);\r\n    formData.append('native_language', userData.nativeLanguage);\r\n    formData.append('target_language', userData.learningLanguage);\r\n    console.log(blob);\r\n    const response = await fetch('http://localhost:5000/start_conversation', {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    const data = await response.json();\r\n      console.log(data);\r\n      setResponseText(data.text_response);\r\n      const audio = new Audio(`data:audio/wav;base64,${data.audio_response}`);\r\n      const transcriptionWithUserName = `${userData.name}: ${data.transcript}`;\r\n      setTranscriptionText(transcriptionWithUserName);\r\n      audio.play();\r\n    };\r\n    return (\r\n      <div className=\"\">\r\n        <img src={teacher} alt=\"Personaje\" className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-2/3 w-1/2 md:w-1/3\" />\r\n        <div className=\"absolute bottom-0 left-0 w-full h-2/4 bg-black bg-opacity-50 p-4 rounded-t\">\r\n          <h1 className=\"text-6xl font-bold mb-4 text-white text-center\">Hello I'am your teacher</h1>\r\n          <textarea className=\"w-full p-2 mb-4 h-40\" readOnly value={responseText} />\r\n          <div className=\"flex space-x-4\">\r\n          <textarea type=\"text\" className=\"w-full p-2\" placeholder=\"Introduce tu texto aquÃ­\" value={transcriptionText}/>\r\n          <button onClick={startRecording} disabled={isRecording}>\r\n            Record\r\n          </button>\r\n          <button onClick={stopRecording} disabled={!isRecording}>\r\n            Stop\r\n          </button>\r\n          <audio\r\n            ref={audioPlayer}\r\n            src={blobURL}\r\n            controls=\"controls\"\r\n            onEnded={() => setPlay(false)} //event handler when audio has stopped playing\r\n          />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}